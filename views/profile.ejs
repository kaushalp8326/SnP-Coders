<% if (local.isAdmin) { %>
    <%- include("adminheader") -%>
<% } else { %> 
    <%- include("homeheader") -%>
<% } %>

<section class="content5 studiom4_content5 cid-sq4X6Ihgnd" id="content5-i">



    <div class="mbr-overlay" style="opacity: 0.6; background-color: rgb(0, 0, 0);"></div>

    <div class="container align-center">
        <div class="row justify-content-md-center">
            <div class="mbr-white col-md-12 col-lg-12">
                <h1 class="mbr-section-title mbr-semibold pb-3 mbr-fonts-style align-center display-2"><%= user.username %>'s Profile</h1>
                
                <p class="mbr-text mbr-fonts-style align-center display-5"><%= user.bio %><br></p>    
                <% if (local.following.includes(user.username)) { %>
                    <div class="mbr-section-btn align-center"><a class="btn btn-danger display-7" style="margin-right: 0;" href="/unfollow/username/<%= user.username %>" onmouseout="this.innerText='Following'" onmouseover="this.innerText='Unfollow'">Following</a></div>
                <% } else { %>
                    <div class="mbr-section-btn align-center"><a class="btn btn-danger display-7" style="margin-right: 0;" href="/follow/username/<%= user.username %>">Follow</a></div>
                <% } %>
                <% if (local.isAdmin === true) { %>
                    <div class="mbr-section-btn align-center"><a class="btn btn-danger display-7" style="margin-right: 0;" href="/ban/username/<%= user.username %>">Ban</a></div>
                <% } %>
            </div>
        </div>
    </div>
    
</section>

<section class="content3 studiom4_content3 cid-sq4WPh8P6U" id="content3-h">

    

    
    <div class="container">
        <div class="row">
            <div class="card col-12 col-md-6">
                <div class="card-box">
                    <a href="/followers/<%= user.username %>" class="text-white mbr-bold">
                        <h4 class="card-title align-center mbr-fonts-style display-5">Followers&nbsp;<br>
                            <span class="mbr-regular">
                                <%= user.followers.length %>
                            </span>
                        </h4>
                    </a>
                </div>
            </div>
            <div class="card col-12 col-md-6">
                <div class="card-box">
                    <a href="/following/<%= user.username %>" class="text-white mbr-bold">
                        <h4 class="card-title align-center mbr-fonts-style display-5">Following&nbsp;<br>
                            <span class="mbr-regular">
                                <%= user.following.length %>
                            </span>
                        </h4>
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="testimonials2 studiom4_testimonials2 vertical-line cid-sq4XL8SNzK" id="testimonials2-j">

    <div class="container">
        <div class="row">
            <div class="title col-12 align-center">
                <h3 class="mbr-section-subtitle mbr-bold mbr-fonts-style display-7">TIMELINE</h3>
                <h2 class="mbr-bold mbr-fonts-style mbr-section-title mbr-white display-2">Get To Know Me</h2>
            </div>
            <div class="row justify-content-md-left col-12" style="padding-top: 30px;">
                <div class="mbr-section-btn align-center"><button class="btn btn-danger display-7" onclick="filterCollection('All')">All</button>
                </div>
                <% var validInterests = {}; %> 
                <% for (var i = 0; i < interests.length; i++) { %>
                    <% validInterests[interests[i].name] = 1; %>
                <% } %>
                <% for (var i = 0; i < user.interests.length; i++) { %>
                    <% if (validInterests[user.interests[i]]) { %>
                        <div class="mbr-section-btn align-center"><button class="btn btn-danger display-7" onclick="filterCollection('<%= user.interests[i] %>')"><%= user.interests[i] %></button></div>  
                    <% } %> 
                <% } %>
            </div>
            <% for (var i = 0; i < posts.length; i++) { %>
                <% var interestClass = ""; %> 
                <% if (validInterests[posts[i].interest]) { %>
                    <% interestClass = posts[i].interest; %>
                <% } %>        
                <div class="card col-12 col-md-6 col-lg-4 c-item <%= interestClass %>" style="padding: 15px;">
                    <div class="card-inner">
                        <div class="card-img align-left">
                            <% karma = posts[i].likes.length - posts[i].dislikes.length %>
                            <% if (Math.abs(karma) > 9999 && Math.abs(karma) < 1000000) { %>
                                <% karma = (karma / 1000).toFixed(1)%>
                                <span style="color: #f0ad4e; padding-right: 15px"><%= karma %>k</span>
                            <% } else if (Math.abs(karma) > 1000000){ %>
                                <% karma = (karma / 1000000).toFixed(2)%>
                                <span style="color: #f0ad4e; padding-right: 15px"><%= karma %>m</span>
                            <% } else { %>
                                <span style="color: #f0ad4e; padding-right: 15px"><%= karma %></span>
                            <% } %>
                            <% if (posts[i].likes.includes(local.username)) { %>
                                <a href="/unlike/postId/<%= posts[i]._id %>" class="mbr-iconfont mbr-iconfont-1 mobi-mbri-like mobi-mbri" style="padding-right: 15px;color:#e1201d;" onmouseover="this.style.color='#f0ad4e'" onmouseout="this.style.color='#e1201d'"></a>
                            <% } else { %>
                                <a href="/like/postId/<%= posts[i]._id %>" class="mbr-iconfont mbr-iconfont-1 mobi-mbri-like mobi-mbri" style="padding-right: 15px;" onmouseout="this.style.color='#f0ad4e'" onmouseover="this.style.color='#e1201d'"></a>
                            <% } %>
                            <% if (posts[i].dislikes.includes(local.username)) { %>
                                <a href="/undislike/postId/<%= posts[i]._id %>" class="far fa-thumbs-down" style="padding-right: 15px;color:#e1201d;" onmouseover="this.style.color='#f0ad4e'" onmouseout="this.style.color='#e1201d'"></a>
                            <% } else { %>
                                <a href="/dislike/postId/<%= posts[i]._id %>" class="far fa-thumbs-down" style="padding-right: 15px;color:#f0ad4e;" onmouseout="this.style.color='#f0ad4e'" onmouseover="this.style.color='#e1201d'"></a>
                            <% } %>
                            <a href="/viewPost/postId/<%= posts[i]._id %>" class="mbr-iconfont mbr-iconfont-1 mobi-mbri-chat mobi-mbri" style="padding-right: 15px;" onmouseout="this.style.color='#f0ad4e'" onmouseover="this.style.color='#e1201d'"></a>
                            <a href="/report/postId/<%= posts[i]._id %>" class="far fa-flag" style="padding-right: 15px;color:#f0ad4e;" onmouseout="this.style.color='#f0ad4e'" onmouseover="this.style.color='#e1201d'"></a>    
                        </div>
                        <div class="card-box">
                            
                            <p class="mbr-text align-left mbr-fonts-style display-7">
                                <%= posts[i].text %>
                            </p>
                            <p>
                                <a href="/interest/<%= interestClass %>" class="mbr-author-desc mbr-fonts-style display-4" style="color: #e9204f;" onmouseout="this.style.color='#e9204f'" onmouseover="this.style.color='#f0ad4e'">
                                    <%= interestClass %>
                                </a>
                            </p>
                            <div class="card-people">
                                <div class="user_image">
                                    <% if (user.picture != null) { %>
                                        <img src="<%= user.picture %>" alt="">
                                    <% } else { %>
                                        <img src="/assets/images/mbr-455x455.png" alt="">
                                    <% } %>
                                </div>
                                <div class="wrapper-name">
                                    <a href="/profile/<%= posts[i].author %>" class="mbr-author-name mbr-semibold mbr-fonts-style mbr-white display-7" style="color: #fff;" onmouseout="this.style.color='#fff'" onmouseover="this.style.color='#e1201d'">
                                        <%= posts[i].author %>
                                    </a>
                                    <div class="mbr-author-desc mbr-fonts-style display-4">
                                        <%= posts[i].date.toDateString() %></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            <% } %>
        </div>
    </div>
</section>

<%- include("footer") -%>